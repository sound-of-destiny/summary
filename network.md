TCP/IP

- ARQ(Automatic Repeat Request) 自动重复请求，构成了TCP的基础
- 多跳网络错误 : 分组重排序，分组复制，分组泯灭
- TCP三次握手的目的
  - **通信双方数据原点的序列号**
  - 由于TCP不会重传没有数据的报文，因此丢失的报文就会周期性的超时重传
- TCP头部和封装

  - 序列号
- 确认号 : 用于指明在接收方已经顺利收到的最大字节( 加1 )
  - 头部长度
- 标志位
  
  - CWR : 拥塞窗口减（发送方降低它的发送速度）
  
  - ECE : ECN回显（发送方接收到了一个更早的拥塞控制）
  
  - URG : 紧急（紧急指针字段有效）
  
  - ACK : 确认（确认号字段有效）
  
  - PSH : 推送（接收方应尽快给应用程序传递这个数据）表示发送端缓存为空。也就是当当PSH置位的数据包发送完成后，发送端没有其他数据包需要传输
  
  - RST : 重置连接（连接取消，通常是因为错误）
  
  - SYN : 用于初始化一个连接的同步序列号
  
  - FIN : 该报文段的发送方已经结束向对方发送数据
  - 窗口大小
- 校验和
  - 紧急指针
- 如果出现FIN丢失的情况，那么发送方将重新传输直到接收到一个ACK确认为止
- 调用shutdown()函数来代替基本的close()函数，来实现半关闭
- TCP对不含数据的报文段不提供可靠传输，意味着若出现丢包不会重传，因此无需设置重传超时
- TCP拥塞控制实现   分为三个方面

  - 基于丢包的拥塞控制算法 ---> 基本算法 : 慢启动、拥塞避免，改进算法 newReno

    - 慢启动 : 以越来越快的速度发送数据直到丢包，慢启动的条件
      - TCP连接刚建立
      - 检测到RTO导致的丢包
      - TCP
- newReno: 
- 网络字节序
  - 大小端问题主要涉及的是非单字节非字符串外的其余数据的表示和传递
  - 大端和小端有其各自的优势
    - 我们知道计算机正常的内存增长方式是从低到高(当然栈不是)，取数据方式是从基址根据偏移找到他们的位置，从他们的存储方式可以看出，大端存储因为第一个字节就是高位，从而很容易知道它是正数还是负数，对于一些数值判断会很迅速。
    - 小端存储 第一个字节是它的低位，符号位在最后一个字节，这样在做数值四则运算时从低位每次取出相应字节运算，最后直到高位，并且最终把符号位刷新，这样的运算方式会更高效
- TLS和SSL区别 : SSL是TLS的前身
  - 所有TLS版本在2011年3月[rfc 6176](https://link.jianshu.com/?t=https%3A%2F%2Ftools.ietf.org%2Fhtml%2Frfc6176)中进一步完善，取消了它们对SSL的向下兼容，TLS再也不支持安全套接字层（SSL）2.0版
  - 
- http和https区别 : https, 全称Hyper Text Transfer Protocol Secure，相比http多了一个secure。这是由TLS（SSL）提供的
  - https协议需要到ca申请证书，一般免费证书较少，因而需要一定费用
  - http是超文本传输协议，信息是明文传输，https则是具有安全性的ssl加密传输协议
  - http和https使用的是完全不同的连接方式，用的端口也不一样，前者是80，后者是443
  - http的连接很简单，是无状态的；HTTPS协议是由SSL+HTTP协议构建的可进行加密传输、身份认证的网络协议，比http协议安全
- https的作用
  - 建立一个信息安全通道，来保证数据传输的安全
  - 确认网站的真实性
- https优缺点
  - 优点
    - 使用HTTPS协议可认证用户和服务器，确保数据发送到正确的客户机和服务器
    - HTTPS协议是由SSL+HTTP协议构建的可进行加密传输、身份认证的网络协议，要比http协议安全，可防止数据在传输过程中不被窃取、改变，确保数据的完整性
    - HTTPS是现行架构下最安全的解决方案，虽然不是绝对安全，但它大幅增加了中间人攻击的成本
    - 谷歌曾在2014年8月份调整搜索引擎算法，并称“比起同等HTTP网站，采用HTTPS加密的网站在搜索结果中的排名将会更高”
  - 缺点
    - HTTPS协议握手阶段比较费时，会使页面的加载时间延长近50%，增加10%到20%的耗电
    - HTTPS连接缓存不如HTTP高效，会增加数据开销和功耗，甚至已有的安全措施也会因此而受到影响
    - SSL证书需要钱，功能越强大的证书费用越高，个人网站、小网站没有必要一般不会用
    - SSL证书通常需要绑定IP，不能在同一IP上绑定多个域名，IPv4资源不可能支撑这个消耗
    - TTPS协议的加密范围也比较有限，在黑客攻击、拒绝服务攻击、服务器劫持等方面几乎起不到什么作用。最关键的，SSL证书的信用链体系并不安全，特别是在某些国家可以控制CA根证书的情况下，中间人攻击一样可行
- 跨站脚本攻击 XSS : 跨站脚本攻击（Cross-Site Scripting, XSS），可以将代码注入到用户浏览的网页上，这种代码包括 HTML 和 JavaScript。另一个用户浏览了含有这个内容的页面将会跳转到 domain.com 并携带了当前作用域的 Cookie。如果这个论坛网站通过 Cookie 管理用户登录状态，那么攻击者就可以通过这个 Cookie 登录被攻击者的账号了
  - 设置Cookie为HttpOnly
  - 过滤特殊字符
- 跨站请求伪造 CSRF : 是攻击者通过一些技术手段欺骗用户的浏览器去访问一个自己曾经认证过的网站并执行一些操作（如发邮件，发消息，甚至财产操作如转账和购买商品）。由于浏览器曾经认证过，所以被访问的网站会认为是真正的用户操作而去执行
  - 检查 Referer 首部字段
  - 添加校验 Token
  - 输入验证码
- XSS 利用的是用户对指定网站的信任，CSRF 利用的是网站对用户浏览器的信任